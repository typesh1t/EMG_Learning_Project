# Notebooks 测试说明

## ✅ 已修复的问题

1. **模块导入问题** - 使用三重后备方案，确保能成功导入
2. **滤波器边界问题** - 修复了 `ValueError: Digital filter critical frequencies must be 0 < Wn < 1`

## 📝 测试步骤

### 1. 重启Jupyter内核（重要！）
在VSCode的Jupyter Notebook中：
- 点击右上角的内核选择器
- 选择 **Restart**
- 或使用快捷键：`Ctrl+Shift+P` → 搜索 "Restart Kernel"

### 2. 测试每个Notebook

#### 00_快速开始.ipynb
✅ **预期输出（第一个单元格）：**
```
项目根目录: c:\Users\Administrator\EMG_Learning_Project
✓ 库导入成功！
```

✅ **预期输出（信号生成）：**
```
✓ EMG信号生成成功！
  信号长度: 5000 个采样点
  采样率: 1000 Hz
  时长: 5 秒
```

#### 03_特征提取实践.ipynb
✅ **预期输出（第一个单元格）：**
```
项目根目录: c:\Users\Administrator\EMG_Learning_Project
code目录存在: True
sys.path[0]: c:\Users\Administrator\EMG_Learning_Project
方法1失败: ...
方法2也失败: ...
最后尝试：直接添加模块路径...
✓ 模块导入成功（方法3）！
✓ 环境配置完成！
```

✅ **预期输出（特征提取）：**
```
时域特征：
----------------------------------------
  MAV       :   0.xxxxxx
  RMS       :   0.xxxxxx
  ...（10个特征）

频域特征：
----------------------------------------
  MNF           :   xx.xxxxxx
  MDF           :   xx.xxxxxx
  ...（8个特征）
```

#### 04_完整流程演示.ipynb
✅ **步骤1：导入** → 看到 "✓ 模块导入成功！"
✅ **步骤2：信号生成** → 看到信号生成完成
✅ **步骤3：滤波** → **不应该有ValueError错误**
✅ **步骤4：特征提取** → 看到18个特征
✅ **步骤5：分类器** → 看到准确率（如 95.00%）

#### 05_分类器详解与对比.ipynb
✅ **SVM训练** → 看到准确率和训练时间
✅ **KNN训练** → 看到准确率
✅ **Random Forest训练** → 看到准确率
✅ **MLP训练** → 看到网络结构和准确率
✅ **K-Means聚类** → 看到聚类结果
✅ **混淆矩阵** → 看到4个混淆矩阵对比图

## 🔍 验证清单

### 导入测试
- [ ] 第一个单元格运行成功
- [ ] 看到 "✓ 模块导入成功" 或 "✓ 模块导入成功（方法X）"
- [ ] 没有ImportError错误

### 滤波器测试（最关键）
- [ ] 滤波代码运行成功
- [ ] **没有 ValueError: Digital filter critical frequencies** 错误
- [ ] 能看到滤波前后对比图

### 特征提取测试
- [ ] 能提取18个特征（10个时域 + 8个频域）
- [ ] 特征值都是合理的数字（不是NaN或Inf）
- [ ] 能看到特征可视化图表

### 分类器测试
- [ ] 所有分类器都能训练成功
- [ ] 能看到准确率（通常 > 70%）
- [ ] 能看到混淆矩阵

## ❗ 常见问题

### Q: 还是有 "code is not a package" 错误
**A:** 重启Jupyter内核！这是最重要的步骤。

### Q: ValueError: Digital filter critical frequencies
**A:** 这个已经修复了。如果还有：
1. 确保已经git pull最新代码
2. 重启Jupyter内核
3. 重新运行单元格

### Q: 特征值都是NaN
**A:** 检查信号是否太短或全是0。最少需要200个采样点。

### Q: 分类器准确率很低（< 50%）
**A:** 这是正常的，因为使用的是模拟数据。真实数据会更好。

## ✅ 成功标志

如果您能：
1. ✅ 成功导入所有模块
2. ✅ 运行滤波器代码没有错误
3. ✅ 提取18个特征
4. ✅ 训练分类器并看到准确率

**恭喜！所有notebooks都能正常工作了！**

## 📊 快速测试命令

在notebook中运行以下代码进行快速测试：

```python
# 测试导入
from filters import EMGFilters
from features import EMGFeatures
print("✓ 导入成功")

# 测试滤波
import numpy as np
fs = 1000
signal = np.random.randn(1000)
filters = EMGFilters(fs=fs)
signal_clean = filters.preprocess_emg(signal, remove_powerline=True)
print("✓ 滤波成功")

# 测试特征提取
features_time = EMGFeatures.extract_time_features(signal_clean)
features_freq = EMGFeatures.extract_freq_features(signal_clean, fs=fs)
print(f"✓ 特征提取成功: {len(features_time)+len(features_freq)}个特征")
```

## 🎯 明天教学建议

1. **提前测试**：在上课前运行一遍所有notebooks
2. **准备应对**：如果学生遇到导入问题，让他们重启内核
3. **重点演示**：
   - 滤波前后对比（非常直观）
   - 18个特征的物理意义
   - 混淆矩阵的解读
4. **互动环节**：让学生修改参数看效果变化

祝教学顺利！🎓
