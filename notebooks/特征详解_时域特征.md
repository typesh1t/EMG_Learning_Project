# 时域特征详解 - 深度教学材料

## 📊 时域特征分类

时域特征可以分为三大类：

### 1. 幅度特征（Amplitude Features）
反映信号的强度和能量
- MAV, RMS, PEAK, MEAN, IEMG

### 2. 变化特征（Variability Features）
反映信号的波动和复杂度
- VAR, WL, DASDV

### 3. 频率估计特征（Frequency Estimation Features）
通过时域方法估计频率信息
- ZC, SSC

---

## 🔬 每个特征的详细解释

### 1. MAV (Mean Absolute Value) - 平均绝对值

#### 数学定义
```
MAV = (1/N) × Σ|x_i|
```
N: 样本数, x_i: 第i个采样点

#### 物理意义
- **最常用的EMG幅度指标**
- 直接反映肌肉激活程度
- 与肌肉收缩力成正比关系

#### 应用场景
✅ **假肢控制**：MAV → 抓取力度
- MAV < 0.1 mV → 轻握（10%力度）
- MAV = 0.3 mV → 中度握（50%力度）
- MAV > 0.5 mV → 用力握（80%力度）

✅ **疲劳监测**：
- 持续收缩时，MAV会先升高（招募更多运动单元）
- 然后下降（肌肉疲劳）

✅ **临床评估**：
- 健康人：0.2-0.8 mV
- 神经肌肉疾病：< 0.1 mV
- 痉挛：> 1.0 mV

#### 优缺点
✅ 优点：
- 计算简单快速
- 物理意义明确
- 对噪声相对鲁棒

❌ 缺点：
- 受电极位置影响大
- 受皮下脂肪影响
- 个体差异大（需归一化）

---

### 2. RMS (Root Mean Square) - 均方根

#### 数学定义
```
RMS = √[(1/N) × Σ(x_i²)]
```

#### 物理意义
- **EMG信号的有效值**
- 反映信号的"功率"
- 与肌肉产生的力密切相关

#### 为什么RMS比MAV好？
1. **理论基础更强**：RMS是信号功率的度量
2. **更符合生理学**：肌肉力 ∝ √(招募的运动单元数) ≈ RMS
3. **统计性质好**：高斯噪声的RMS = 标准差

#### 应用场景
✅ **力矩估计**：
```
预测力矩 = k × RMS + b
k, b: 通过校准获得
```

✅ **疲劳指数**：
```
疲劳指数 = (RMS_初始 - RMS_结束) / RMS_初始 × 100%
> 30% → 显著疲劳
```

✅ **生物反馈**：
- 实时显示RMS帮助患者学习控制肌肉

#### RMS vs MAV 对比

| 特征 | MAV | RMS |
|------|-----|-----|
| 物理意义 | 平均幅度 | 有效功率 |
| 数值关系 | MAV < RMS | RMS > MAV |
| 对噪声 | 较鲁棒 | 更敏感 |
| 计算速度 | 稍快 | 稍慢 |
| 理论基础 | 一般 | 强 |

**结论**：科研用RMS，实时系统用MAV

---

### 3. VAR (Variance) - 方差

#### 数学定义
```
VAR = (1/N) × Σ(x_i - mean)²
```

#### 物理意义
- 信号围绕均值的**离散程度**
- 反映肌肉激活的**不规律性**

#### 临床应用
✅ **颤抖检测**：
- 帕金森病：VAR异常升高
- 本态性震颤：VAR有特征性波动

✅ **肌张力障碍**：
- 痉挛：VAR很大（突发性激活）
- 强直：VAR较小（持续性激活）

---

### 4. WL (Waveform Length) - 波形长度

#### 数学定义
```
WL = Σ|x_(i+1) - x_i|
```

#### 物理意义
- 信号的"路径长度"
- 反映信号的**复杂度和频率**
- WL大 → 信号变化剧烈

#### 直观理解
想象用一根绳子沿着信号波形铺设：
- 静息期：绳子很短（信号平坦）
- 收缩期：绳子很长（信号起伏大）

#### 应用场景
✅ **手势识别**：
```
WL_握拳 > WL_张开 > WL_静息
不同手势有不同的"纹理"
```

✅ **疲劳检测**：
- 疲劳时：WL下降（信号变简单）
- 原因：高频运动单元失活

---

### 5. ZC (Zero Crossing) - 过零率

#### 数学定义
```
ZC = Σ sgn(x_i × x_(i+1) < 0)
sgn(): 符号函数
```
计数信号穿过零点的次数

#### 物理意义
- **时域估计的频率**
- ZC高 → 高频成分多
- 粗略但快速的频率指标

#### 为什么要设置阈值？
```python
# 原始定义（容易被噪声干扰）
ZC_raw = 信号从正到负 or 从负到正

# 改进定义（抗噪声）
ZC_robust = 信号穿越零点 AND |x_(i+1) - x_i| > 阈值
```
阈值（通常0.02-0.05 mV）防止噪声导致的假过零

#### 应用场景
✅ **实时系统**：
- ZC计算极快（只需比较符号）
- 用于快速估计信号频率

✅ **疲劳监测**：
- 疲劳 → MDF降低 → ZC减少

---

### 6. SSC (Slope Sign Change) - 斜率符号变化

#### 数学定义
```
SSC = Σ sgn[(x_(i+1) - x_i) × (x_i - x_(i-1)) < 0]
```
计数波形"拐点"的数量

#### 物理意义
- 信号的**峰谷数量**
- 反映信号的**振荡频率**
- SSC高 → 信号变化快

#### SSC vs ZC 的区别

```
信号: ___/\___/\___    (两个波峰)
ZC: 4次过零
SSC: 2次拐点

SSC更关注波峰/波谷，ZC关注过零点
```

#### 应用
- 与ZC配合使用
- 提供互补的频率信息

---

### 7. IEMG (Integrated EMG) - 积分肌电

#### 数学定义
```
IEMG = Σ|x_i|
```
就是MAV × N（样本数）

#### 物理意义
- 信号的**总能量**
- 与肌肉做的**总功**相关

#### 应用
✅ **疲劳研究**：
```
单次收缩的IEMG ∝ 消耗的ATP
持续收缩时：IEMG曲线 → 疲劳模型
```

---

### 8. DASDV (Difference Absolute Standard Deviation Value)

#### 数学定义
```
DASDV = √[(1/(N-1)) × Σ(x_(i+1) - x_i)²]
```

#### 物理意义
- 相邻采样点差值的标准差
- 反映信号的**变化速率**

#### 与WL的关系
```
WL = Σ|差分|  (一阶矩)
DASDV = √Σ(差分²)  (二阶矩)

DASDV²≈ WL，但DASDV对大的变化更敏感
```

---

### 9. PEAK - 峰值

#### 定义
```
PEAK = max(|x_i|)
```

#### 应用
✅ **动作检测**：
- PEAK突然升高 → 肌肉开始激活
- 用于触发事件

❌ 缺点：
- 对噪声和伪影非常敏感
- 一个异常点就能污染整个特征
- **单独使用不推荐**

---

### 10. MEAN - 均值

#### 定义
```
MEAN = (1/N) × Σx_i
```

#### 为什么MEAN很少用？
- 理想的EMG信号：MEAN ≈ 0（交流信号）
- MEAN ≠ 0 通常表示：
  - 电极极化（电极问题）
  - 运动伪影
  - 设备漂移

#### 应用
✅ **质量控制**：
```
IF |MEAN| > 0.1 mV:
    警告：信号质量差或电极问题
```

---

## 🎯 特征选择指南

### 快速分类（实时系统）
```
MAV + WL + ZC
↓
- 计算最快
- 准确率70-80%
- 延迟 < 100ms
```

### 高精度分类（离线分析）
```
MAV + RMS + VAR + WL + ZC + SSC + IEMG + DASDV
↓
- 准确率85-95%
- 计算稍慢
```

### 疲劳监测专用
```
RMS + MDF + WL
↓
- RMS: 肌力变化
- MDF: 频率下移
- WL: 复杂度下降
```

---

## 💡 实战技巧

### 1. 归一化是关键
```python
# 错误：直接使用原始特征
MAV_user1 = 0.3  # 瘦弱的人
MAV_user2 = 0.8  # 肌肉发达的人
# 相同动作，MAV差异巨大！

# 正确：最大自主收缩（MVC）归一化
MAV_normalized = MAV / MVC_MAV
# 现在都在0-1范围内
```

### 2. 窗口长度的选择
```
窗口太短（< 100ms）：
  ✅ 响应快
  ❌ 特征不稳定

窗口太长（> 500ms）：
  ✅ 特征稳定
  ❌ 响应延迟大

推荐：
  - 假肢控制：150-250ms
  - 手势识别：200-300ms
  - 疲劳分析：500-1000ms
```

### 3. 组合特征的力量
```
单个特征准确率：50-60%
MAV + RMS：65-70%
MAV + RMS + WL：75-80%
所有10个时域特征：85-90%

但注意：
- 特征太多可能导致过拟合
- 需要进行特征选择
```

---

## 🧪 课堂练习

### 练习1：特征计算
给定信号：`x = [0.1, -0.2, 0.3, -0.1, 0.2]`

手工计算：
1. MAV = ?
2. RMS = ?
3. ZC = ?

### 练习2：特征选择
你需要设计一个**假肢手**，要求：
- 识别5种手势
- 延迟 < 200ms
- 在手机上运行（计算资源有限）

你会选择哪些特征？为什么？

### 练习3：案例分析
患者A的MAV在持续收缩时呈现以下模式：
```
0s: MAV = 0.3
10s: MAV = 0.4 (升高！)
20s: MAV = 0.35
30s: MAV = 0.25 (下降)
```

这说明了什么生理现象？

---

## 📚 拓展阅读

### 经典论文
1. Hudgins et al. (1993) - "A new strategy for multifunction myoelectric control"
   - 提出了时域特征用于假肢控制

2. Phinyomark et al. (2012) - "Feature reduction and selection for EMG signal classification"
   - 系统比较了各种EMG特征

### 在线资源
- 🔗 PhysioNet - EMG数据库
- 🔗 Ninapro - 假肢手势数据集
- 🔗 SENIAM - EMG传感器放置标准

---

## 🎓 学习检查清单

完成本节后，你应该能够：
- [ ] 解释每个时域特征的物理意义
- [ ] 根据应用场景选择合适的特征
- [ ] 理解特征归一化的重要性
- [ ] 编写代码提取所有10个时域特征
- [ ] 分析不同手势的特征差异

恭喜你掌握了时域特征！接下来学习频域特征...
